<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>git-vogue - a pre-commit check framework</title>
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css" />
        <link href="http://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" type="text/css" href="./css/default.css" />
        <script type="text/javascript" src="./js/jquery.min.js"></script>
        <script type="text/javascript" src="./js/smooth-scroll.js"></script>
        <script type="text/javascript" src="./js/run.js"></script>
    </head>
    <body>
        <header data-scroll-header>
            <div id="navigation">
                <a data-scroll href="#title">Top</a>
                <a data-scroll href="#quickstart">Quickstart</a>
                <a data-scroll href="#plugin-discoverydisabling">Discovery</a>
                <a data-scroll href="#plugins">Plugins</a>
                <a data-scroll href="#uninstalling">Uninstall</a>
                <a data-scroll href="#philosophy">Philosophy</a>
                <a data-scroll href="#plugin-specification">Plugin Specs</a>
                <a href="https://www.anchor.com.au">Anchor</a>
                <a href="https://github.com/anchor/git-vogue">Github</a>
            </div>
        </header>

        <section id="content">
            <h1 id="title">git-vogue - a pre-commit check framework</h1>

            <p>Intended to be used as a git pre-commit hook, <em>git-vogue</em> encourages developers to keep their Haskell code <a href="https://www.youtube.com/watch?v=GuJQSAiODqI">“en vogue”</a> by providing a framework for checking code quality and some supporting plugins.</p>
<p>Currently, <em>git-vogue</em> ships with the following plugins:</p>
<ul>
<li><a href="https://hackage.haskell.org/package/Cabal">cabal</a></li>
<li><a href="http://hackage.haskell.org/package/hlint">hlint</a></li>
<li><a href="https://hackage.haskell.org/package/stylish-haskell">stylish-haskell</a> with automatic fixing</li>
<li><a href="https://hackage.haskell.org/package/ghc-mod">ghc-mod</a></li>
</ul>
<h2 id="quickstart">Quickstart</h2>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cabal</span> install git-vogue</code></pre>
<p>If you wish to set up pre-commit hooks (recommended):</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">git</span> vogue init</code></pre>
<p>With pre-commit hooks set up, <code>git vogue check</code> will be run before every commit. If you wish to check the whole repository, run <code>git vogue check --all</code>.</p>
<p>You can attempt to automatically rectify any problems discovered via <code>git vogue fix</code> and <code>git vogue fix --all</code>. The only plugin that currently supports this auto-fixing is stylish-haskell.</p>
<h2 id="plugin-discoverydisabling">Plugin discovery/disabling</h2>
<p>Running <code>git-vogue plugins</code> will show you the libexec directory in which git-vogue will discover plugins.</p>
<p>Should one or more plugins annoy you, you may disable it by setting it non-executable:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">chmod</span> -x .cabal/libexec/git-vogue/git-vogue-stylish</code></pre>
<p>A more sophisticated interface to plugin manipulation is planned.</p>
<h2 id="plugins">Plugins</h2>
<h3 id="cabal">cabal</h3>
<p>Checks your .cabal file for packaging problems. Can not fix problems automatically.</p>
<h3 id="hlint">hlint</h3>
<p>Checks .hs files for linting issues, respects <code>HLint.hs</code> in the top level of the repository. Can not fix problems automatically.</p>
<h3 id="ghc-mod">ghc-mod</h3>
<p>Checks .hs files (excluding <code>HLint.hs</code> and <code>Setup.hs</code>) as per ghc-mod check. ghc-mod can be temperamental, so if this fails to run the plugin will allow the commit to pass. Can not fix problems automatically.</p>
<h3 id="stylish-haskell">stylish-haskell</h3>
<p>Checks if .hs files would have been modified by stylish-haskell. Respects <code>.stylish-haskell.yaml</code>. Can fix problems automatically.</p>
<h2 id="uninstalling">Uninstalling</h2>
<p>To remove a <code>git-vogue init</code> configured pre-commit hook, run:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">rm</span> .git/hooks/pre-commit</code></pre>
<p><a href="https://www.youtube.com/watch?v=4qXD5l-ZlfA">Here are instructions</a> for uninstalling a cabal package.</p>
<h2 id="philosophy">Philosophy</h2>
<p>At Anchor Engineering, we’re pretty un-dogmatic about using one editor or even one OS for development. As such, we’ve found ourselves in need of a common benchmark for linting, formatting and code quality checks.</p>
<p>We wanted a tool that would:</p>
<ul>
<li>Install in one command</li>
<li>Require nothing to be learned for a new developer</li>
<li>Tell that developer what they need to fix in the code that they modify and that code only.</li>
</ul>
<p>git-vogue aims to satisfy these needs, whilst saving developers from the drudgery of installing, configuring and running each of these tools independently.</p>
<h2 id="plugin-specification">Plugin specification</h2>
<p><strong>The interface</strong> for an executable (to be called by git-vogue) is a single command line argument, one of:</p>
<ul>
<li>check</li>
<li>fix</li>
<li>name</li>
</ul>
<p>The plugin can assume that the CWD will be set to the top-level directory of the package.</p>
<p>The plugin will receive a list of all files in the current repository that may be looked at via STDIN when running in “check” or “fix” mode. These file paths will be absolute and newline separated. The plugin is expected to filter them appropriate to its needs.</p>
<h3 id="invariants-for-well-behaved-plugin-commands">Invariants for well-behaved plugin commands</h3>
<ul>
<li><code>name</code> will return a human-readable name one line</li>
<li><code>check</code> will not modify any files</li>
<li><code>check</code> will exit with a return code of:
<ul>
<li>No errors - 0</li>
<li>Errors need fixing - 1</li>
<li>Catastrophic failure to check - 2</li>
</ul></li>
<li><code>fix</code> is idempotent</li>
<li><code>fix</code> will exit with a return code of:
<ul>
<li>The code is now good (changes may or may not have been made) - 0</li>
<li>Some errors remain - 1</li>
<li>Catastrophic failure to check - 2</li>
</ul></li>
<li>If <code>fix</code> returns “success” (return code 0), <code>check</code> must no longer fail</li>
</ul>
        </section>

        <footer>
            <p class="info">
                © <a href="https://www.anchor.com.au">Anchor</a> 2015.
                <br />
                Icons by <a href="https://github.com/Keyamoon/IcoMoon-Free">IcoMoon</a> (<a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>) and <a href="https://github.com/github/octicons">Github</a> (<a href="http://choosealicense.com/licenses/mit/">MIT</a>)
            </p>
            <a class="top-marker" data-scroll href="#title">Top</a>
        </footer>
    </body>
</html>
